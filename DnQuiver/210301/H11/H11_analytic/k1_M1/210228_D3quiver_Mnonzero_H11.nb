(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14611,        356]
NotebookOptionsPosition[     13744,        336]
NotebookOutlinePosition[     14102,        352]
CellTagsIndexPosition[     14059,        349]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.820154299958469*^9, 3.8201543008420887`*^9}},
 CellLabel->
  "(Local_2) In[10]:=",ExpressionUUID->"306560f9-f540-4aec-aa78-ac3293f68dc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"super", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\<\\!\\(\\*SuperscriptBox[\\(\>\"", ",", 
     RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<\\), \\(\>\"", ",", 
     RowBox[{"ToString", "[", "b", "]"}], ",", "\"\<\\)]\\)\\>\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sub", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\<\\!\\(\\*SubscriptBox[\\(\>\"", ",", 
     RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<\\), \\(\>\"", ",", 
     RowBox[{"ToString", "[", "b", "]"}], ",", "\"\<\\)]\\)\\>\>\""}], 
    "]"}]}], ";"}]}], "Input",
 CellLabel->
  "(Local_2) In[1]:=",ExpressionUUID->"9a61cf35-1a15-4127-ad1d-08d6d89e748b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.820154301475582*^9, 3.820154305993762*^9}, 
   3.820161559407242*^9, 3.820162064074039*^9},
 CellLabel->
  "(Local_2) In[3]:=",ExpressionUUID->"1f20f5f3-8f4d-4cdb-9310-bcfac873f3aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mM", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.820154309274691*^9, 3.820154309926573*^9}, 
   3.8203182055615673`*^9, 3.820318667988283*^9, {3.8228335549601927`*^9, 
   3.82283355861335*^9}, 3.822847541612546*^9, {3.82300360524327*^9, 
   3.82300360549937*^9}, {3.823011601489532*^9, 3.823011608694544*^9}, {
   3.823509065972871*^9, 3.823509067367242*^9}, {3.82355354391153*^9, 
   3.823553544178093*^9}},
 CellLabel->
  "(Local_2) In[4]:=",ExpressionUUID->"3e0e9206-02ab-44a9-b056-5454b55e507b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Kappa]", "=", 
   RowBox[{"2", "*", "k"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ell", "[", "rr_", "]"}], ":=", 
   RowBox[{"mM", "+", 
    FractionBox["1", "2"], "-", "rr"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.823022982197851*^9, {3.823023275916147*^9, 3.823023276196024*^9}},
 CellLabel->
  "(Local_2) In[6]:=",ExpressionUUID->"b74b04e6-4add-4a82-aea6-6674bde771f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nmax", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.82302564234004*^9, 3.823025644101191*^9}, 
   3.823585612215126*^9},
 CellLabel->
  "(Local_2) In[8]:=",ExpressionUUID->"91ca3248-0d5f-49bf-a0ea-564e8f3b298a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Lambda]1old", "=", 
           RowBox[{"Import", "[", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<../../../lambda1/lambda1_analytic/k\>\"", ",", 
              RowBox[{"ToString", "[", "k", "]"}], ",", "\"\<_M\>\"", ",", 
              RowBox[{"ToString", "[", "mM", "]"}], ",", 
              "\"\</210228_lambda1_k\>\"", ",", 
              RowBox[{"ToString", "[", "k", "]"}], ",", "\"\<_M\>\"", ",", 
              RowBox[{"ToString", "[", "mM", "]"}], ",", "\"\<_s\>\"", ",", 
              RowBox[{"ToString", "[", "s", "]"}], ",", "\"\<_n\>\"", ",", 
              RowBox[{"ToString", "[", "n", "]"}], ",", "\"\<.m\>\""}], "]"}],
             "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"vr", "=", 
               RowBox[{"Exp", "[", 
                FractionBox[
                 RowBox[{
                  RowBox[{"-", "2"}], "*", "\[Pi]", "*", "I", "*", 
                  RowBox[{"ell", "[", "r", "]"}]}], 
                 RowBox[{"2", "*", "k"}]], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"logvf", "=", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "2"}], "*", "\[Pi]", "*", "I", "*", 
                 RowBox[{"ell", "[", "r", "]"}]}], 
                RowBox[{"2", "*", "k"}]]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"flist", "=", 
               RowBox[{"CoefficientList", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   SqrtBox["I"]}], "*", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"\[Pi]", "*", "I"}], 
                    RowBox[{"2", "*", "k"}]]}], "*", 
                    SuperscriptBox[
                    RowBox[{"ell", "[", "r", "]"}], "2"]}], "]"}], "*", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"\[Pi]", "*", "I"}], 
                    RowBox[{"2", "*", "k"}]]}], "*", 
                    RowBox[{"ell", "[", "r", "]"}]}], "]"}], "*", 
                  FractionBox["1", 
                   RowBox[{"2", "*", "\[Pi]"}]], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    FractionBox[
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "mM"], 
                    RowBox[{"vr", "+", "u"}]], "*", 
                    FractionBox["I", 
                    RowBox[{"2", "*", "\[Pi]"}]], "*", 
                    RowBox[{"(", 
                    RowBox[{"logvr", "-", "logu"}], ")"}]}], "+", 
                    RowBox[{
                    FractionBox["I", 
                    RowBox[{"2", "*", "\[Pi]"}]], "*", 
                    RowBox[{"(", 
                    RowBox[{"logvr", "-", "logu"}], ")"}], "*", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"m", "-", "1"}]], "*", 
                    SuperscriptBox["vr", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"ell", "[", "m", "]"}]}], "-", 
                    FractionBox["1", "2"]}]], "*", 
                    SuperscriptBox["u", 
                    RowBox[{
                    RowBox[{"ell", "[", "m", "]"}], "-", 
                    FractionBox["1", "2"]}]]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", "mM"}], "}"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "mM"], 
                    RowBox[{"vr", "+", "u"}]], "+", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"m", "-", "1"}]], "*", 
                    SuperscriptBox["vr", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"ell", "[", "m", "]"}]}], "-", 
                    FractionBox["1", "2"]}]], "*", 
                    SuperscriptBox["u", 
                    RowBox[{
                    RowBox[{"ell", "[", "m", "]"}], "-", 
                    FractionBox["1", "2"]}]]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", "mM"}], "}"}]}], "]"}]}], 
                    ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", "2"]}], "*", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox["u", 
                    RowBox[{"2", "*", "k"}]], "-", "1"}], 
                    RowBox[{
                    SuperscriptBox["u", 
                    RowBox[{"2", "*", "k"}]], "+", "1"}]]}], ")"}]}]}], ")"}],
                   "*", "\[Lambda]1old"}], ",", "logu"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"H11", "=", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox[
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"2", "*", "\[Pi]", "*", "I"}], ")"}], 
                    RowBox[{"j", "+", "1"}]], 
                    RowBox[{"j", "+", "1"}]]}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Residue", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"flist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"BernoulliB", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"\[Pi]", "*", "I"}], "k"], "*", 
                    RowBox[{"(", 
                    RowBox[{"m", "-", 
                    FractionBox["1", "2"]}], ")"}]}], "+", 
                    RowBox[{"Log", "[", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"\[Pi]", "*", "I"}], "k"]}], "*", 
                    RowBox[{"(", 
                    RowBox[{"m", "-", 
                    FractionBox["1", "2"]}], ")"}]}], "]"}], "*", "du"}]}], 
                    "]"}]}], 
                    RowBox[{"2", "*", "\[Pi]", "*", "I"}]]}], "]"}]}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"u", "\[Rule]", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"\[Pi]", "*", "I"}], "k"], "*", 
                    RowBox[{"(", 
                    RowBox[{"m", "-", 
                    FractionBox["1", "2"]}], ")"}]}], "]"}], "+", "du"}]}], 
                    "}"}]}], "//", "ExpandDenominator"}], ")"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"du", ",", "0"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"2", "*", "k"}]}], "}"}]}], "]"}], "//", 
                    "Together"}], "//", "ExpandDenominator"}], ")"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "0", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "flist", "]"}], "-", "1"}]}], 
                  "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{"\"\<210228_H11_k\>\"", ",", 
                  RowBox[{"ToString", "[", "k", "]"}], ",", "\"\<_M\>\"", ",", 
                  RowBox[{"ToString", "[", "mM", "]"}], ",", "\"\<_r\>\"", 
                  ",", 
                  RowBox[{"ToString", "[", "r", "]"}], ",", "\"\<_s\>\"", ",", 
                  RowBox[{"ToString", "[", "s", "]"}], ",", "\"\<_n\>\"", ",", 
                  RowBox[{"ToString", "[", "n", "]"}], ",", "\"\<.m\>\""}], 
                 "]"}], ",", "H11"}], "]"}], ";"}], "\[IndentingNewLine]", 
             ")"}], ",", 
            RowBox[{"{", 
             RowBox[{"r", ",", "1", ",", "mM"}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "1", ",", "mM"}], "}"}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "nmax"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQnXXbrPRa9RvHbY+PgukFU+qrQfQvj65GEB16J78N
RMfsspoCoj1P9+wHqzsxDUJvlVpwHUhPlpEB03NU9XeC6DUfzoNpH3vhsyA6
JZ3/EohePJ856QOQvuCuXwKiL5mEuHvWvHE8dOa8H4juvlgYDqJFtkjHgGim
L6LJIDpoRUgViP4rolYHVr+1ogFE5+Uyt4Hoi603O0H0xkObZoJoOZFdYLq/
e26dF8icWuN6EK1ncEvSF0izrHglBaL3KPw9eRhIt8yefxlE2/NUht4E0jnK
7A0gesGhT7IvgfQmHjs5EB00/9e2L0A6IdJpP4hesmTuLRDNJ6f4CES3Fex4
D6J/37wFpgEaNsAY
  "],
 CellLabel->
  "(Local_2) In[9]:=",ExpressionUUID->"4f54bc8e-5f1a-4cdf-95c7-2ec39ceddf43"]
},
Evaluator->"Local_2",
WindowSize->{1440, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 230, 5, 41, "Input",ExpressionUUID->"306560f9-f540-4aec-aa78-ac3293f68dc0"],
Cell[791, 27, 832, 20, 63, "Input",ExpressionUUID->"9a61cf35-1a15-4127-ad1d-08d6d89e748b"],
Cell[1626, 49, 328, 7, 41, "Input",ExpressionUUID->"1f20f5f3-8f4d-4cdb-9310-bcfac873f3aa"],
Cell[1957, 58, 611, 12, 63, "Input",ExpressionUUID->"3e0e9206-02ab-44a9-b056-5454b55e507b"],
Cell[2571, 72, 443, 12, 79, "Input",ExpressionUUID->"b74b04e6-4add-4a82-aea6-6674bde771f7"],
Cell[3017, 86, 252, 6, 41, "Input",ExpressionUUID->"91ca3248-0d5f-49bf-a0ea-564e8f3b298a"],
Cell[3272, 94, 10468, 240, 781, "Input",ExpressionUUID->"4f54bc8e-5f1a-4cdf-95c7-2ec39ceddf43"]
}
]
*)

