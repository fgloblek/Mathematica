(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11618,        289]
NotebookOptionsPosition[     10560,        267]
NotebookOutlinePosition[     10918,        283]
CellTagsIndexPosition[     10875,        280]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.820154299958469*^9, 3.8201543008420887`*^9}},
 CellLabel->
  "(Local_2) In[18]:=",ExpressionUUID->"306560f9-f540-4aec-aa78-ac3293f68dc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"super", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\<\\!\\(\\*SuperscriptBox[\\(\>\"", ",", 
     RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<\\), \\(\>\"", ",", 
     RowBox[{"ToString", "[", "b", "]"}], ",", "\"\<\\)]\\)\\>\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sub", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\<\\!\\(\\*SubscriptBox[\\(\>\"", ",", 
     RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<\\), \\(\>\"", ",", 
     RowBox[{"ToString", "[", "b", "]"}], ",", "\"\<\\)]\\)\\>\>\""}], 
    "]"}]}], ";"}]}], "Input",
 CellLabel->
  "(Local_2) In[1]:=",ExpressionUUID->"9a61cf35-1a15-4127-ad1d-08d6d89e748b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.820154301475582*^9, 3.820154305993762*^9}, 
   3.820161559407242*^9, 3.820162064074039*^9},
 CellLabel->
  "(Local_2) In[3]:=",ExpressionUUID->"1f20f5f3-8f4d-4cdb-9310-bcfac873f3aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mM", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mMex", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.820154309274691*^9, 3.820154309926573*^9}, 
   3.8203182055615673`*^9, 3.820318667988283*^9, {3.8228335549601927`*^9, 
   3.82283355861335*^9}, 3.822847541612546*^9, {3.82300360524327*^9, 
   3.82300360549937*^9}, {3.823011601489532*^9, 3.823011608694544*^9}, {
   3.823239477525073*^9, 3.823239481438611*^9}, {3.823239562370796*^9, 
   3.8232395649041157`*^9}, {3.8235091985790873`*^9, 3.823509199968273*^9}},
 CellLabel->
  "(Local_2) In[4]:=",ExpressionUUID->"3e0e9206-02ab-44a9-b056-5454b55e507b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Kappa]", "=", 
   RowBox[{"2", "*", "k"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ell", "[", "rr_", "]"}], ":=", 
   RowBox[{"mM", "+", 
    FractionBox["1", "2"], "-", "rr"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.8232483148710003`*^9},
 CellLabel->
  "(Local_2) In[7]:=",ExpressionUUID->"744acee4-7562-47d8-ae70-91ede96e0e94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xmin", "=", 
   RowBox[{"-", "50"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nofpoints", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx", "=", 
   FractionBox[
    RowBox[{"xmax", "-", "xmin"}], 
    RowBox[{"nofpoints", "-", "1"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xlist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"xmin", "+", 
      RowBox[{"dx", "*", "i"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nofpoints"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", "=", "200"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.823248318027853*^9, {3.82324836056282*^9, 3.823248399961841*^9}, {
   3.823248447682246*^9, 3.823248450588685*^9}, {3.823248652048411*^9, 
   3.8232486905840797`*^9}, 3.8232497330567083`*^9, {3.8232501504223757`*^9, 
   3.8232501510847397`*^9}, {3.8232502156013727`*^9, 
   3.8232502669556923`*^9}, {3.823260199927389*^9, 3.823260228598927*^9}, {
   3.8232608172223377`*^9, 3.823260841825821*^9}, {3.823509247237595*^9, 
   3.8235092644338007`*^9}},
 CellLabel->
  "(Local_2) In[9]:=",ExpressionUUID->"f9073d97-b81f-4a17-88b0-8dab8dbbb66f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"yr", "=", 
       RowBox[{"2", "*", "\[Pi]", "*", "I", "*", 
        RowBox[{"(", 
         RowBox[{"mMex", "-", 
          RowBox[{"ell", "[", "r", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vtilde", "[", "r", "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{
            SqrtBox["I"], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[Pi]", "*", "I"}], 
                RowBox[{"2", "*", "k"}]]}], "*", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"mMex", "-", 
                 RowBox[{"ell", "[", "r", "]"}]}], ")"}], "2"]}], "]"}], "*", 
            
            FractionBox["1", 
             RowBox[{"4", "*", "k", "*", 
              RowBox[{"Cosh", "[", 
               FractionBox[
                RowBox[{"yr", "-", "x"}], 
                RowBox[{"4", "*", "k"}]], "]"}]}]], "*", 
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"Tanh", "[", 
                FractionBox["x", "2"], "]"}], "2"], "-", 
              FractionBox[
               RowBox[{"I", "*", 
                RowBox[{"(", 
                 RowBox[{"yr", "-", "x"}], ")"}]}], 
               RowBox[{"4", "*", "\[Pi]", "*", "k"}]]}], ")"}], "*", 
            RowBox[{"Exp", "[", 
             FractionBox["x", 
              RowBox[{"4", "*", "k"}]], "]"}], "*", 
            FractionBox["1", 
             RowBox[{"1", "+", 
              RowBox[{"Exp", "[", 
               FractionBox["x", 
                RowBox[{"4", "*", "k"}]], "]"}]}]], "*", 
            FractionBox["dx", 
             RowBox[{"2", "*", "\[Pi]"}]]}], ",", "prec"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "xlist"}], "}"}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "1", ",", "mM"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.823247997741763*^9, 3.823248045904366*^9}, {
  3.82324808365795*^9, 3.823248185318589*^9}, {3.8232484528011*^9, 
  3.823248458833775*^9}, {3.823259440687029*^9, 3.823259555450486*^9}, {
  3.823259653660901*^9, 3.823259659957803*^9}, {3.823259702324163*^9, 
  3.823259703409881*^9}, {3.823260792200451*^9, 3.823260797457279*^9}, {
  3.8235092031742992`*^9, 3.823509205210833*^9}},
 CellLabel->
  "(Local_2) In[15]:=",ExpressionUUID->"b7bb9395-2ecd-42cb-89f2-4d3e176be489"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nmax", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.823239579035055*^9, 3.823239581801737*^9}},
 CellLabel->
  "(Local_2) In[16]:=",ExpressionUUID->"bcfd1470-b6c6-459e-a636-b53f5cde53ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Lambda]1tilde", "=", 
           RowBox[{"Import", "[", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<../../../lambda1/lambda1_numerical/k\>\"", ",", 
              RowBox[{"ToString", "[", "k", "]"}], ",", "\"\<_M\>\"", ",", 
              RowBox[{"ToString", "[", "mM", "]"}], ",", 
              "\"\</210228_lambda1tilde_k\>\"", ",", 
              RowBox[{"ToString", "[", "k", "]"}], ",", "\"\<_M\>\"", ",", 
              RowBox[{"ToString", "[", "mM", "]"}], ",", "\"\<_s\>\"", ",", 
              RowBox[{"ToString", "[", "s", "]"}], ",", "\"\<_n\>\"", ",", 
              RowBox[{"ToString", "[", "n", "]"}], ",", "\"\<_xmax\>\"", ",", 
              
              RowBox[{"ToString", "[", "xmax", "]"}], ",", 
              "\"\<_nofpoints\>\"", ",", 
              RowBox[{"ToString", "[", "nofpoints", "]"}], ",", 
              "\"\<.m\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"H11", "=", 
               RowBox[{
                RowBox[{"vtilde", "[", "r", "]"}], ".", "\[Lambda]1tilde"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{"\"\<210228_H11_k\>\"", ",", 
                  RowBox[{"ToString", "[", "k", "]"}], ",", "\"\<_M\>\"", ",", 
                  RowBox[{"ToString", "[", "mM", "]"}], ",", "\"\<_r\>\"", 
                  ",", 
                  RowBox[{"ToString", "[", "r", "]"}], ",", "\"\<_s\>\"", ",", 
                  RowBox[{"ToString", "[", "s", "]"}], ",", "\"\<_n\>\"", ",", 
                  RowBox[{"ToString", "[", "n", "]"}], ",", "\"\<_xmax\>\"", 
                  ",", 
                  RowBox[{"ToString", "[", "xmax", "]"}], ",", 
                  "\"\<_nofpoints\>\"", ",", 
                  RowBox[{"ToString", "[", "nofpoints", "]"}], ",", 
                  "\"\<.m\>\""}], "]"}], ",", "H11"}], "]"}], ";"}], 
             "\[IndentingNewLine]", ")"}], ",", 
            RowBox[{"{", 
             RowBox[{"r", ",", "1", ",", "mM"}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "1", ",", "mM"}], "}"}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "nmax"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.82324848973211*^9, 3.82324851547195*^9}, {
  3.823249557612837*^9, 3.823249558603138*^9}, {3.82324969661112*^9, 
  3.823249701535428*^9}, {3.823259567728126*^9, 3.823259742124916*^9}, {
  3.8232598377685003`*^9, 3.82325983841394*^9}, {3.823259954952903*^9, 
  3.8232599587925177`*^9}, {3.823260043786639*^9, 3.8232600472432337`*^9}, {
  3.8235092201806498`*^9, 3.8235092232748947`*^9}},
 CellLabel->
  "(Local_2) In[17]:=",ExpressionUUID->"905f448f-325b-4205-844e-f444a11da7a0"]
},
Evaluator->"Local_2",
WindowSize->{1440, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 230, 5, 41, "Input",ExpressionUUID->"306560f9-f540-4aec-aa78-ac3293f68dc0"],
Cell[791, 27, 832, 20, 63, "Input",ExpressionUUID->"9a61cf35-1a15-4127-ad1d-08d6d89e748b"],
Cell[1626, 49, 328, 7, 41, "Input",ExpressionUUID->"1f20f5f3-8f4d-4cdb-9310-bcfac873f3aa"],
Cell[1957, 58, 733, 14, 84, "Input",ExpressionUUID->"3e0e9206-02ab-44a9-b056-5454b55e507b"],
Cell[2693, 74, 396, 11, 79, "Input",ExpressionUUID->"744acee4-7562-47d8-ae70-91ede96e0e94"],
Cell[3092, 87, 1295, 33, 170, "Input",ExpressionUUID->"f9073d97-b81f-4a17-88b0-8dab8dbbb66f"],
Cell[4390, 122, 2685, 69, 201, "Input",ExpressionUUID->"b7bb9395-2ecd-42cb-89f2-4d3e176be489"],
Cell[7078, 193, 228, 5, 41, "Input",ExpressionUUID->"bcfd1470-b6c6-459e-a636-b53f5cde53ba"],
Cell[7309, 200, 3247, 65, 252, "Input",ExpressionUUID->"905f448f-325b-4205-844e-f444a11da7a0"]
}
]
*)

